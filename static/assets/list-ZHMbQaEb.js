import{g as P}from"./inventory-QY7kwVo4.js";import{s as g}from"./purchase-D8MZpE6K.js";import{d as A,O as U,c as V,h as f,e as N,f as r,s as F,a as n,b as u,ae as O,U as R,V as T,ar as D,an as E,ax as L,o as h,az as M,aA as $,B as j,ac as _,as as q}from"./.pnpm-B0XLMEKp.js";import{_ as G}from"./index-CnvvL9sG.js";import"./request-DINYhP-L.js";const H={class:"page-container"},J=A({__name:"list",setup(K){const d=u(!0),m=u([]),x=u(0),c=u(!1),s=u([]),a=O({page_num:1,page_size:10}),w=R(()=>[{title:"商品名称",dataIndex:"product_name",key:"product_name",sorter:!0,ellipsis:!0,fixed:"left",width:200},{title:"商品规格",dataIndex:"product_spec",key:"product_spec",sorter:!0,ellipsis:!0,width:120},{title:"当前库存数量",dataIndex:"inventory_num",key:"inventory_num",sorter:!0,ellipsis:!0,width:120},{title:"库存单位成本",dataIndex:"inventory_cost",key:"inventory_cost",sorter:!0,ellipsis:!0,width:150,customRender:t=>t.record.inventory_cost.toFixed(2)},{title:"库存总价值",dataIndex:"inventory_value",key:"inventory_value",sorter:!0,ellipsis:!0,width:150,customRender:t=>t.record.inventory_value.toFixed(2)},{title:"最后采购日期",dataIndex:"last_purchase_date",key:"last_purchase_date",sorter:!0,ellipsis:!0,width:150},{title:"最后销售日期",dataIndex:"last_sale_date",key:"last_sale_date",sorter:!0,ellipsis:!0,width:150,customRender:t=>t.record.last_sale_date||"-"}]),l=async()=>{c.value=!0;try{const t=await P(a);m.value=t.data.list,x.value=t.data.total}catch(t){console.error("获取库存列表失败:",t),T.error("获取数据失败，请稍后重试")}finally{c.value=!1}},k=t=>{a.page_num=t,l()},b=(t,e)=>{a.page_size=e,a.page_num=1,l()},S=async t=>{if(t)try{const e=await g({keyword:t});Array.isArray(e.data)?s.value=e.data.map(i=>({label:i,value:i})):s.value=[]}catch(e){console.error("获取商品列表失败:",e),s.value=[]}},C=()=>{a.page_num=1,a.page_size=10,a.product_name="",a.min_num=void 0,a.max_num=void 0,s.value=[],l()};return U(async()=>{try{const t=await g({});Array.isArray(t.data)?s.value=t.data.map(e=>({label:e,value:e})):s.value=[]}catch(t){console.error("获取商品列表失败:",t)}l()}),(t,e)=>{const i=M,p=q,v=$,y=j,z=D,I=E,B=L;return h(),V("div",H,[e[8]||(e[8]=f("h1",null,"当前库存查询",-1)),d.value?(h(),N(z,{key:0,model:a,layout:"inline",style:{"margin-bottom":"16px"}},{default:r(()=>[n(p,{label:"商品名称"},{default:r(()=>[n(i,{value:a.product_name,"onUpdate:value":e[0]||(e[0]=o=>a.product_name=o),placeholder:"请输入商品名称","show-search":"","filter-option":!1,options:s.value,onSearch:S,style:{width:"200px"}},null,8,["value","options"])]),_:1}),n(p,{label:"库存数量范围"},{default:r(()=>[n(v,{value:a.min_num,"onUpdate:value":e[1]||(e[1]=o=>a.min_num=o),min:0,placeholder:"最小数量",style:{width:"100px"}},null,8,["value"]),e[4]||(e[4]=f("span",{style:{margin:"0 8px"}},"-",-1)),n(v,{value:a.max_num,"onUpdate:value":e[2]||(e[2]=o=>a.max_num=o),min:0,placeholder:"最大数量",style:{width:"100px"}},null,8,["value"])]),_:1}),n(p,null,{default:r(()=>[n(y,{type:"primary",onClick:l},{default:r(()=>[...e[5]||(e[5]=[_("查询",-1)])]),_:1}),n(y,{style:{"margin-left":"8px"},onClick:C},{default:r(()=>[...e[6]||(e[6]=[_("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])):F("",!0),n(I,{checked:d.value,"onUpdate:checked":e[3]||(e[3]=o=>d.value=o),style:{"margin-bottom":"16px"}},{default:r(()=>[...e[7]||(e[7]=[_("显示搜索栏",-1)])]),_:1},8,["checked"]),n(B,{columns:w.value,"data-source":m.value,"row-key":o=>o.product_name,pagination:{showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:o=>`共 ${o} 条记录`,current:a.page_num,pageSize:a.page_size,onChange:k,onShowSizeChange:b},scroll:{x:1400},loading:c.value},null,8,["columns","data-source","row-key","pagination","loading"])])}}}),ee=G(J,[["__scopeId","data-v-4789403c"]]);export{ee as default};
